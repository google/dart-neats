# Created with package:mono_repo v2.1.0
language: dart

dart: stable

# Custom configuration
branches:
  exclude: []
services:
  - "redis-server"

env:
  - PKGS=acyclic_steps
  - PKGS=canonical_json
  - PKGS=chunked_stream
  - PKGS=http_methods
  - PKGS=neat_cache
  - PKGS=neat_periodic_task
  - PKGS=pem
  - PKGS=retry
  - PKGS=sanitize_html
  - PKGS=safe_url_check
  - PKGS=shelf_router
  - PKGS=shelf_router_generator
  - PKGS=slugid
  - PKGS=yaml_edit

jobs:
  include:
    - stage: analyze
      name: `dartanalyzer .`
      env: PKGS="acyclic_steps canonical_json chunked_stream http_methods neat_cache neat_periodic_task pem retry sanitize_html safe_url_check shelf_router shelf_router_generator slugid yaml_edit"
      script: ./tool/travis.sh dartanalyzer
    - stage: analyze
      name: "dartfmt -n --set-exit-if-changed .`"
      env: PKGS="acyclic_steps canonical_json chunked_stream http_methods neat_cache neat_periodic_task pem retry sanitize_html safe_url_check shelf_router shelf_router_generator slugid yaml_edit"
      script: ./tool/travis.sh dartfmt

stages:
  - analyze

script: ./tool/travis.sh test

cache:
  directories:
    - "$HOME/.pub-cache"
